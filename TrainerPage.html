<!DOCTYPE html>
<html>
<head>
    <title>Worst Fan Made Pokemon Website</title>
    <link rel="shortcut icon" href="http://i257.photobucket.com/albums/hh233/neji0313/BALLPO1.png">
    <link href="trainerStyle.css" type="text/css" rel="stylesheet">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <!--<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap-theme.min.css">-->

    <!--<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>-->
    <script src="/socket.io/socket.io.js"></script>
    <script>
        var iosocket = io.connect('http://localhost:3000');

        $(function(){
            iosocket.emit('heal', 1);

            if(getCookie('trainerID') == null)
                window.location.href='/'
            else
                iosocket.emit('getTrainerPokemon', getCookie('trainerID'));
        })

        function getCookie(name) {
            var regexp = new RegExp("(?:^" + name + "|;\s*"+ name + ")=(.*?)(?:;|$)", "g");
            var result = regexp.exec(document.cookie);
            return (result === null) ? null : result[1];
        }

        iosocket.on('returnedPokemon', function (trainerPokemon){
            $('#pokePictures').html('');
            var position = 0;
            var divider = trainerPokemon.length;
            trainerPokemon.forEach(function (poke){
                $('#pokePictures').append('<div id="pokemen" class="col-md-' + (12/divider) + ' col-mid-offset-' + position * (12/divider) + '">' +
                                          '<img src="' + poke[0] + '" class="imgClass" style="max-width:100%;max-height:100%;">' +
                                          '<h3>' + poke[1] + '</h3>' +
                                          '<h3>Level: ' + poke[2] + '</h3>' +
                                          '<h4>HP: </h4><meter style="width:75%" value="' + poke[3] + '" min="0" max="' + poke[4] + '"></meter><h4>' + poke[3] + '/' + poke[4] + '</h4>' +
                                          '<h4>Attack: ' + poke[5] + '</h4>' +
                                          '<h4>Defense: ' + poke[6] + '</h4>' +
                                          '<h4>Special: ' + poke[7] + '</h4>' +
                                          '<h4>Speed: ' + poke[8] + '</h4></div>')
                position++;
            });
        });

        iosocket.on('setTitle', function(trainerName){
            $(document).attr('title', 'Trainer ' + trainerName);
            $('#trainerName').html(trainerName);
            if(trainerName[trainerName.length - 1] == 's')
                $('#trainerName').append("'");
            else
                $('#trainerName').append("'s");
        });

    </script>
</head>
<body class="container">
<div id="navAndHeader"></div>
<script type="text/javascript">
    $(function() {
        $("#navAndHeader").load("/template"); // add "/"
        console.log('in header')
    });
</script>
<div id="trainerss"></div>
<h2><div id="trainerName">Your</div> Pokemon</h2>
<div id="pokePictures" class="row-fluid"></div>
</body>
</html>